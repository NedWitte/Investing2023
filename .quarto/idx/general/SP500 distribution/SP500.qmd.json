{"title":"The SP500","markdown":{"yaml":{"title":"The SP500","author":"JNW","description":"stuff","date":"2023-08-04","image":"sp500.png"},"headingText":"Introduction to the S&P 500","containsRefs":false,"markdown":"\n\n**The SP500 index**\n\n\nThe **S&P 500** is a stock market index that measures the performance of 500 of the largest publicly traded companies in the United States. It is widely regarded as a key indicator of the overall health and performance of the U.S. stock market and is used by investors, analysts, and economists to assess the state of the economy.\n\n## Market Events and Performance\n\nThe performance of the S&P 500 is subject to various market events, including economic data releases, corporate earnings reports, geopolitical developments, and central bank decisions. Market fluctuations in the S&P 500 can have a cascading effect on other financial markets and impact investor confidence.\n\n```{r}\n#| echo: false\n#| output: false\nlibrary(tidyquant)\nlibrary(quantmod)\nlibrary(ggplot2)\nlibrary(tidyverse)\nlibrary(tidyquant)\nlibrary(plotly)\n\n```\n\n```{r}\n#| echo: false\n#| output: false\n\n#data preparation\nsp500_df <- tq_index(\"SP500\")\n\nsp500_df_top10 <- sp500_df %>%\n  arrange(desc(weight)) %>%\n  slice(1:10)\n\n# Assuming sp500_df is your original dataframe\nsp500_df_top10 <- sp500_df_top10 %>%\n  arrange(desc(weight)) %>%\n  slice(1:10) %>%\n  bind_rows(data.frame(symbol = \"Top11-500\", company = \"Top11-500\" ,weight = (1-sum(sp500_df_top10$weight))))\n\n```\n\nThis is the distribution of the SP500. Scroll over the plot to get more detailed data.\n\n```{r}\n#| echo: false\n#| output: false\nlibrary(plotly)\n\n# Assuming sp500_df_top10 is your dataframe\nfig <- plot_ly(\n  labels = sp500_df_top10$symbol,\n  values = sp500_df_top10$weight,\n  type = \"pie\",\n  textinfo = \"label+percent\",\n  insidetextorientation = \"radial\",\n  sort = FALSE\n) %>%\nlayout(\n  title = \"Top 10 Stocks by Weight\",\n  scene = list(\n    annotations = list(\n      text = sp500_df_top10$company,\n      x = 0.5,\n      y = 0.5,\n      showarrow = FALSE,\n      font = list(size = 5)\n    )\n  )\n)\n\n```\n\n```{r}\n# Display the interactive 3D pie chart\nfig\n\nprint(paste(\"So it is nicely visible that the top 10 biggest companies by market capitalization are taking roughly\", as.character(round(sum(sp500_df_top10$weight[1:10]),3)*100), \"% of the cake.\"))\n```\n\nHere is the chart of the SP500 since 1945:\n\n```{r}\n#| echo: false\n#| output: false\n\n\n# Fetch S&P 500 data\n\nsp <- tq_get(\"^GSPC\", from = \"1945-01-01\", to = \"2035-01-01\")\n\n#Filter data for the last 2 years\nlast_2_years <- sp[sp$date >= as.Date(Sys.Date()) - 365*2, ]\n\n# Create a plotly interactive chart\nplotly_data <- sp %>%\n  plot_ly(x = ~date, y = ~adjusted, type = \"scatter\", mode = \"lines\") %>%\n  layout(title = \"S&P 500 Closing Prices\",\n         xaxis = list(title = \"Date\"),\n         yaxis = list(title = \"Adjusted Closing Price\"))\n\n```\n\n```{r}\n#| output: true\n# Display the interactive plot\nplotly_data\n```\n\nAnd this a plot of the performance of the last two years:\n\n```{r}\n#| echo: false\n#| output: false\n\n# Create a plotly interactive chart for the last 2 years\nplot_ly(data = last_2_years, x = ~date, y = ~adjusted, type = \"scatter\", mode = \"lines\") %>%\n  layout(title = \"S&P 500 Performance (Last 2 Years)\", yaxis = list(title = \"Price\"))\n\n```\n\n```{r}\n# Display the interactive plot\nplotly_data\n```\n\nIt is also interesting to look at the logarythmic chart:\n\n```{r}\n#| echo: false\n#| output: false\n\n# Fetch S&P 500 data\nsp <- sp %>% mutate(adjusted = log(adjusted))\n\nplotly_data <- sp %>%\n  plot_ly(x = ~date, y = ~adjusted, type = \"scatter\", mode = \"lines\") %>%\n  layout(title = \"S&P 500 Closing Prices log-scale\",\n         xaxis = list(title = \"Date\"),\n         yaxis = list(title = \"Adjusted Closing Price\"))\n```\n\n```{r}\n# Display the interactive plot\nplotly_data\n```\n\n\\`\\`\\`\n\n```{r}\n#| echo: false\n#| output: false\n\n\n# Load S&P 500 data before the crash\ndata_before <- tq_get(\"^GSPC\", from = \"2019-01-01\", to = \"2020-02-19\")\n\n# Load S&P 500 data after the crash\ndata_after <- tq_get(\"^GSPC\", from = \"2020-02-20\", to = \"2022-04-01\")\n\ndata_normal <- tq_get(\"^GSPC\", from = \"2022-04-01\", to = \"2040-01-01\")\n\n# Create a combined data frame\ncombined_data <- rbind(mutate(data_before, Period = \"Pre-Pandemic\"),\n                       mutate(data_after, Period = \"Pandemic\"),\n                       mutate(data_normal , Period = \"Normal\"))\n\n```\n\n```{r}\n# Plot the data\nggplot(combined_data, aes(x = date, y = adjusted, color = Period)) +\n  geom_line() +\n  labs(title = \"S&P 500 Performance Before and After COVID-19 Crash\",\n       x = \"Date\",\n       y = \"Adjusted Closing Price\",\n       color = \"Period\") +\n  theme_minimal()\n```\n\n\\`\\`\\`\n\n## Conclusion\n\nIn summary, the S&P 500 is a crucial index that provides insight into the performance of the U.S. stock market and, by extension, the broader economy. Its composition, calculation methodology, and historical significance make it an essential tool for investors and analysts alike.\n\nFor up-to-date information on the S&P 500, please refer to reputable financial news sources and market data providers.\n","srcMarkdownNoYaml":"\n\n**The SP500 index**\n\n# Introduction to the S&P 500\n\nThe **S&P 500** is a stock market index that measures the performance of 500 of the largest publicly traded companies in the United States. It is widely regarded as a key indicator of the overall health and performance of the U.S. stock market and is used by investors, analysts, and economists to assess the state of the economy.\n\n## Market Events and Performance\n\nThe performance of the S&P 500 is subject to various market events, including economic data releases, corporate earnings reports, geopolitical developments, and central bank decisions. Market fluctuations in the S&P 500 can have a cascading effect on other financial markets and impact investor confidence.\n\n```{r}\n#| echo: false\n#| output: false\nlibrary(tidyquant)\nlibrary(quantmod)\nlibrary(ggplot2)\nlibrary(tidyverse)\nlibrary(tidyquant)\nlibrary(plotly)\n\n```\n\n```{r}\n#| echo: false\n#| output: false\n\n#data preparation\nsp500_df <- tq_index(\"SP500\")\n\nsp500_df_top10 <- sp500_df %>%\n  arrange(desc(weight)) %>%\n  slice(1:10)\n\n# Assuming sp500_df is your original dataframe\nsp500_df_top10 <- sp500_df_top10 %>%\n  arrange(desc(weight)) %>%\n  slice(1:10) %>%\n  bind_rows(data.frame(symbol = \"Top11-500\", company = \"Top11-500\" ,weight = (1-sum(sp500_df_top10$weight))))\n\n```\n\nThis is the distribution of the SP500. Scroll over the plot to get more detailed data.\n\n```{r}\n#| echo: false\n#| output: false\nlibrary(plotly)\n\n# Assuming sp500_df_top10 is your dataframe\nfig <- plot_ly(\n  labels = sp500_df_top10$symbol,\n  values = sp500_df_top10$weight,\n  type = \"pie\",\n  textinfo = \"label+percent\",\n  insidetextorientation = \"radial\",\n  sort = FALSE\n) %>%\nlayout(\n  title = \"Top 10 Stocks by Weight\",\n  scene = list(\n    annotations = list(\n      text = sp500_df_top10$company,\n      x = 0.5,\n      y = 0.5,\n      showarrow = FALSE,\n      font = list(size = 5)\n    )\n  )\n)\n\n```\n\n```{r}\n# Display the interactive 3D pie chart\nfig\n\nprint(paste(\"So it is nicely visible that the top 10 biggest companies by market capitalization are taking roughly\", as.character(round(sum(sp500_df_top10$weight[1:10]),3)*100), \"% of the cake.\"))\n```\n\nHere is the chart of the SP500 since 1945:\n\n```{r}\n#| echo: false\n#| output: false\n\n\n# Fetch S&P 500 data\n\nsp <- tq_get(\"^GSPC\", from = \"1945-01-01\", to = \"2035-01-01\")\n\n#Filter data for the last 2 years\nlast_2_years <- sp[sp$date >= as.Date(Sys.Date()) - 365*2, ]\n\n# Create a plotly interactive chart\nplotly_data <- sp %>%\n  plot_ly(x = ~date, y = ~adjusted, type = \"scatter\", mode = \"lines\") %>%\n  layout(title = \"S&P 500 Closing Prices\",\n         xaxis = list(title = \"Date\"),\n         yaxis = list(title = \"Adjusted Closing Price\"))\n\n```\n\n```{r}\n#| output: true\n# Display the interactive plot\nplotly_data\n```\n\nAnd this a plot of the performance of the last two years:\n\n```{r}\n#| echo: false\n#| output: false\n\n# Create a plotly interactive chart for the last 2 years\nplot_ly(data = last_2_years, x = ~date, y = ~adjusted, type = \"scatter\", mode = \"lines\") %>%\n  layout(title = \"S&P 500 Performance (Last 2 Years)\", yaxis = list(title = \"Price\"))\n\n```\n\n```{r}\n# Display the interactive plot\nplotly_data\n```\n\nIt is also interesting to look at the logarythmic chart:\n\n```{r}\n#| echo: false\n#| output: false\n\n# Fetch S&P 500 data\nsp <- sp %>% mutate(adjusted = log(adjusted))\n\nplotly_data <- sp %>%\n  plot_ly(x = ~date, y = ~adjusted, type = \"scatter\", mode = \"lines\") %>%\n  layout(title = \"S&P 500 Closing Prices log-scale\",\n         xaxis = list(title = \"Date\"),\n         yaxis = list(title = \"Adjusted Closing Price\"))\n```\n\n```{r}\n# Display the interactive plot\nplotly_data\n```\n\n\\`\\`\\`\n\n```{r}\n#| echo: false\n#| output: false\n\n\n# Load S&P 500 data before the crash\ndata_before <- tq_get(\"^GSPC\", from = \"2019-01-01\", to = \"2020-02-19\")\n\n# Load S&P 500 data after the crash\ndata_after <- tq_get(\"^GSPC\", from = \"2020-02-20\", to = \"2022-04-01\")\n\ndata_normal <- tq_get(\"^GSPC\", from = \"2022-04-01\", to = \"2040-01-01\")\n\n# Create a combined data frame\ncombined_data <- rbind(mutate(data_before, Period = \"Pre-Pandemic\"),\n                       mutate(data_after, Period = \"Pandemic\"),\n                       mutate(data_normal , Period = \"Normal\"))\n\n```\n\n```{r}\n# Plot the data\nggplot(combined_data, aes(x = date, y = adjusted, color = Period)) +\n  geom_line() +\n  labs(title = \"S&P 500 Performance Before and After COVID-19 Crash\",\n       x = \"Date\",\n       y = \"Adjusted Closing Price\",\n       color = \"Period\") +\n  theme_minimal()\n```\n\n\\`\\`\\`\n\n## Conclusion\n\nIn summary, the S&P 500 is a crucial index that provides insight into the performance of the U.S. stock market and, by extension, the broader economy. Its composition, calculation methodology, and historical significance make it an essential tool for investors and analysts alike.\n\nFor up-to-date information on the S&P 500, please refer to reputable financial news sources and market data providers.\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":8,"fig-height":6,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":true,"code-overflow":"scroll","code-link":true,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true,"format-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["html/style.scs"],"output-file":"SP500.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.3.433","editor":"visual","theme":"html/my-laterra.scss","fontsize":"1em","title":"The SP500","author":"JNW","description":"stuff","date":"2023-08-04","image":"sp500.png"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}